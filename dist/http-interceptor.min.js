!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.HttpInterceptor=t():e.HttpInterceptor=t()}(self,(function(){return function(){"use strict";var e={d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{createBaseInterceptor:function(){return u},createBeaconInteceptor:function(){return d},createFetchInterceptor:function(){return f},createImageInterceptor:function(){return l},createXhrInterceptor:function(){return p}});class n extends Error{}class r extends Error{}class o{constructor(){this.useNative=!1,this.filterAndAdapterStack=[]}enableInterceptor(){this.useNative=!1}disableInterceptor(){this.useNative=!0}addFilterAndAdapter(e,t){"function"==typeof e?"function"==typeof t?this.filterAndAdapterStack.push([e,t]):console.error(new n("adapter must be a function")):console.error(new n("filter must be a function"))}callFilterAndAdapter(e,t){if(0===this.filterAndAdapterStack.length)return[e,t];for(const[n,o]of this.filterAndAdapterStack){if(!0!==n(e,t))continue;const s=o(e,t);Array.isArray(s)&&2===s.length?(e=s[0],t=s[1]):console.error(new r("adapter must return an array with two elements, the first element is the url, the second element is the data"))}return[e,t]}apply(){throw new Error("Abstract method cannot be called")}}class s extends o{apply(){const e=window.navigator.sendBeacon;window.navigator.sendBeacon=(t,n)=>{if(this.useNative)return e.call(window.navigator,t,n);const[r,o]=this.callFilterAndAdapter(t,n);return e.call(window.navigator,r,o)}}}class c extends o{constructor(){super()}nativeSetHandler(e){return e}newSetHandler(e){const t=e.indexOf("?");let n,r;-1===t?(n=e,r=""):(n=e.slice(0,t),r=e.slice(t+1));const[o,s]=this.callFilterAndAdapter(n,r);return o&&s?o+"?"+s:o}apply(){const e=this,t=window.Image;window.Image=class extends t{constructor(t,n){super(t,n),Object.defineProperty(this,"src",{get(){return this._src},set(t=""){t=e.useNative?e.nativeSetHandler(t):e.newSetHandler(t),this._src=t,this.setAttribute("src",t)},configurable:!0,enumerable:!0})}}}}class i extends o{apply(){const e=this,t=window.XMLHttpRequest;window.XMLHttpRequest=class extends t{constructor(){super(...arguments),this._src=""}open(e,t,n=!0,r,o){this._src=t,super.open(e,t,n,r,o)}send(t){if(e.useNative)return super.send(t);const[n,r]=e.callFilterAndAdapter(this._src,t);return super.send(r)}}}}class a extends o{apply(){const e=this,t=window.fetch;window.fetch=function(n,r){if(e.useNative)return t(n,r);const[o,s]=e.callFilterAndAdapter(n,null==r?void 0:r.body);return r&&s&&(r.body=s),t(o,r)}}}function u(){return new o}function d(){return new s}function l(){return new c}function p(){return new i}function f(){return new a}return t}()}));