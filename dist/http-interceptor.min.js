!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.HttpInterceptor=t():e.HttpInterceptor=t()}(self,(()=>(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{createBaseInterceptor:()=>i,createBeaconInteceptor:()=>c,createImageInterceptor:()=>l});class r extends Error{}class n extends Error{}class o{constructor(){this.useNative=!1,this.filterAndAdapterStack=[]}enableInterceptor(){this.useNative=!1}disableInterceptor(){this.useNative=!0}addFilterAndAdapter(e,t){"function"==typeof e?"function"==typeof t?this.filterAndAdapterStack.push([e,t]):console.error(new r("adapter must be a function")):console.error(new r("filter must be a function"))}callFilterAndAdapter(e,t){if(0===this.filterAndAdapterStack.length)return[e,t];for(const[r,o]of this.filterAndAdapterStack){if(!0!==r(e,t))continue;const a=o(e,t);Array.isArray(a)&&2===a.length?(e=a[0],t=a[1]):console.error(new n("adapter must return an array with two elements, the first element is the url, the second element is the data"))}return[e,t]}apply(){throw new Error("Abstract method cannot be called")}}class a extends o{apply(){const e=window.navigator.sendBeacon;window.navigator.sendBeacon=(t,r)=>{if(this.useNative)return e.call(window.navigator,t,r);const[n,o]=this.callFilterAndAdapter(t,r);return e.call(window.navigator,n,o)}}}class s extends o{constructor(){super()}nativeSetHandler(e){return e}newSetHandler(e){const t=e.indexOf("?");let r,n;-1===t?(r=e,n=""):(r=e.slice(0,t),n=e.slice(t+1));const[o,a]=this.callFilterAndAdapter(r,n);return o&&a?o+"?"+a:o}apply(){const e=this,t=window.Image;window.Image=class extends t{constructor(t,r){super(t,r),Object.defineProperty(this,"src",{get(){return this._src},set(t=""){t=e.useNative?e.nativeSetHandler(t):e.newSetHandler(t),this._src=t,this.setAttribute("src",t)},configurable:!0,enumerable:!0})}}}}function i(){return new o}function c(){return new a}function l(){return new s}return t})()));