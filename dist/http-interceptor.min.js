!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.HttpInterceptor=t():e.HttpInterceptor=t()}(self,(function(){return function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{createBaseInterceptor:function(){return u},createBeaconInteceptor:function(){return d},createFetchInterceptor:function(){return h},createImageInterceptor:function(){return l},createXhrInterceptor:function(){return p}});class r extends Error{}class n extends Error{}class s{constructor(){this.useNative=!1,this.filterAndAdapterStack=[]}enableInterceptor(){this.useNative=!1}disableInterceptor(){this.useNative=!0}addFilterAndAdapter(e,t){"function"==typeof e?"function"==typeof t?this.filterAndAdapterStack.push([e,t]):console.error(new r("adapter must be a function")):console.error(new r("filter must be a function"))}callFilterAndAdapter(e,t){if(0===this.filterAndAdapterStack.length)return[e,t];for(const[r,s]of this.filterAndAdapterStack){if(!0!==r(e,t))continue;const o=s(e,t);Array.isArray(o)&&2===o.length?(e=o[0],t=o[1]):console.error(new n("adapter must return an array with two elements, the first element is the url, the second element is the data"))}return[e,t]}apply(){throw new Error("Abstract method cannot be called")}}class o extends s{apply(){const e=window.navigator.sendBeacon;window.navigator.sendBeacon=(t,r)=>{if(this.useNative)return e.call(window.navigator,t,r);const[n,s]=this.callFilterAndAdapter(t,r);return e.call(window.navigator,n,s)}}}class i extends s{constructor(){super()}nativeSetHandler(e){return e}newSetHandler(e){const t=e.indexOf("?");let r,n;-1===t?(r=e,n=""):(r=e.slice(0,t),n=e.slice(t+1));const[s,o]=this.callFilterAndAdapter(r,n);return s&&o?s+"?"+o:s}apply(){const e=this,t=window.Image;window.Image=class extends t{set src(t){e.useNative?this._src=t:(this._src=e.newSetHandler(t),this.setAttribute("src",this._src))}get src(){return this._src}}}}class c extends s{apply(){const e=this,t=window.XMLHttpRequest;window.XMLHttpRequest=class extends t{constructor(){super(...arguments),this._src="",this._headers={}}open(e,t,r=!0,n,s){this._method=e,this._src=t,this._async=r,this._username=n,this._password=s}setRequestHeader(e,t){this._headers[e]=t}send(t){let r="",n=t;return e.useNative||([r,n]=e.callFilterAndAdapter(this._src,t)),super.open(this._method,r,this._async,this._username,this._password),Object.keys(this._headers).forEach((e=>{super.setRequestHeader(e,this._headers[e])})),super.send(n)}}}}class a extends s{apply(){const e=this,t=window.fetch;window.fetch=function(r,n){if(e.useNative)return t(r,n);const[s,o]=e.callFilterAndAdapter(r,null==n?void 0:n.body);return n&&o&&(n.body=o),t(s,n)}}}function u(){return new s}function d(){return new o}function l(){return new i}function p(){return new c}function h(){return new a}return t}()}));